!function(t){t.fn._vs.chart.StackedAreaChart=function(t,e,n){if(this.init=function(t){gravity=new t.phy.b2Vec2(.001,10),t.world.m_gravity=gravity,t.chartPhySetup={grounds:[],wall:[]},this.setupChartPhysics(t)},this.setupChartPhysics=function(t){for(var e=t.settings.chart.spacer,n=t.settings.chart.width/t.settings.data.model.length,s=e,a=t.settings.chart.height/2+t.settings.chart.y,i=(t.settings.chart.height-t.settings.sedimentation.aggregation.height,0),r=0;r<t.settings.data.model.length;r++){if(t.settings.data.model[r].value=0,"undefined"!=typeof t.settings.data.strata&&"undefined"!=typeof t.settings.data.strata[r])for(var o=0;o<t.settings.data.strata[r].length;o++)t.settings.data.model[r].value+=t.settings.data.strata[r][o].value;i+=t.settings.data.model[r].value}for(var r=0;r<t.settings.data.model.length+1;r++){var h=t.settings.chart.x+r*n;t.chartPhySetup.wall[r]=this.createMyChartBox(t,h,a,s,t.settings.chart.height/2,"wall",t.settings.chart.wallColor),r<t.settings.data.model.length&&(t.settings.sedimentation.incoming.point[r]={x:h+n/2,y:t.settings.y}),r<t.settings.data.model.length&&(t.chartPhySetup.grounds[r]=this.createMyChartBox(t,h+n/2,t.settings.chart.height+t.settings.chart.y+t.settings.sedimentation.aggregation.height,n/2,t.settings.chart.height,"lift","rgba(250,250,250,0)"),this.update(t,{cat:r,y:t.settings.chart.height}))}},this.token=function(t,e){var n=e,s={x:t.settings.sedimentation.incoming.point[n].x+2*Math.random(),y:t.settings.sedimentation.incoming.point[n].y+1*Math.random(),t:t.now(),size:t.settings.sedimentation.token.size.original,category:n,lineWidth:0};return s},this.createMyChartBox=function(t,e,n,s,a,i,r){var o=t.settings.options.scale,h=new t.phy.b2FixtureDef;h.density=1,h.friction=.5,h.restitution=.2;var g=new t.phy.b2BodyDef;g.type=t.phy.b2Body.b2_staticBody,h.shape=new t.phy.b2PolygonShape,h.shape.SetAsBox(s/o,a/o),g.position.Set(e/o,n/o);var y=t.world.CreateBody(g).CreateFixture(h);return y.m_userData={type:i,fillStyle:r,w:s,h:a,x:e,y:n},y},this.update=function(t,e){if(null!=t.chartPhySetup.grounds[e.cat]){var n=t.chartPhySetup.grounds[e.cat].GetBody(),s=n.GetWorldCenter();s.y=(e.y+t.settings.chart.height+t.settings.chart.y+t.settings.sedimentation.aggregation.height)/t.settings.options.scale,n.SetPosition(s)}},this.getPositionOld=function(t){for(var e=[],n=0;n<t.chartPhySetup.grounds.length;n++)myElement=t.chartPhySetup.grounds[n],myBody=myElement.GetBody(),e.push({x:myBody.GetWorldCenter().x*t.settings.options.scale,y:myBody.GetWorldCenter().y*t.settings.options.scale,a:myBody.GetAngle(),w:myElement.m_userData.w,h:myElement.m_userData.h,r:myElement.m_userData.r});return e},this.getPosition=function(t){for(var e=[],n=0;n<t.chartPhySetup.grounds.length;n++)myElement=t.chartPhySetup.grounds[n],myBody=myElement.GetBody(),e.push({x:myBody.GetWorldCenter().x*t.settings.options.scale,y:myBody.GetWorldCenter().y*t.settings.options.scale-t.settings.chart.height-t.settings.chart.y,a:myBody.GetAngle(),w:myElement.m_userData.w,h:myElement.m_userData.h,r:myElement.m_userData.r});return e},void 0!=typeof e){var s=this[e](t,n);if(void 0!=typeof s)return s}}}(jQuery);